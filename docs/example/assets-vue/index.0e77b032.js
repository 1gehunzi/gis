import{w as e}from"./style.4dfcf88f.js";import{m as a,u as t,aI as o,O as n,r as i,o as l,q as s,z as d,a as r,f as u,i as p,c,h as v}from"./common.d35d5a69.js";const f={class:"f-mb"},g={key:0},m=a({__name:"index",setup(a){const m=window.mapWork,y=()=>{m.drawPolygon()},h=()=>{m.deleteAll()},_=t("1"),S=()=>{"1"===_.value?m.toBJMS():m.toYLMS()},w=e=>{const a=e.file,t=a.name;"json"!==(null==t?void 0:t.substring(t.lastIndexOf(".")+1,t.length).toLowerCase())&&alert("文件类型不合法,请选择json格式标注文件！"),m.openGeoJSON(a)},E=()=>{m.saveGeoJSON()},{activate:T,disable:b,isActivate:C,updateWidget:L}=e.exports.useWidget();o((()=>{const e=window.mapWork.mars3d;m.graphicLayer.on(e.EventType.drawCreated,(function(e){"1"===_.value&&j(e)})),m.graphicLayer.on([e.EventType.editStart,e.EventType.editMovePoint,e.EventType.editStyle,e.EventType.editRemovePoint],(function(e){j(e)})),m.graphicLayer.on([e.EventType.editStop,e.EventType.removeGraphic],(function(e){setTimeout((()=>{m.graphicLayer.isEditing||b("graphic-editor")}),100)}))}));const j=e=>{const a=e.graphic;a._conventStyleJson||(a.options.style=a.toJSON().style,a._conventStyleJson=!0),C("graphic-editor")?L("graphic-editor",{data:{graphic:n(a)}}):T({name:"graphic-editor",data:{graphic:n(a)}})};return(e,a)=>{const t=i("a-radio"),o=i("a-radio-group"),n=i("a-space"),m=i("mars-button"),T=i("a-upload"),b=i("mars-dialog");return l(),s(b,{visible:!0,right:"10",top:"10"},{default:d((()=>[r("div",f,[u(n,null,{default:d((()=>[u(o,{onChange:S,value:_.value,"onUpdate:value":a[0]||(a[0]=e=>_.value=e),name:"radioGroup"},{default:d((()=>[u(t,{value:"1"},{default:d((()=>[p("编辑模式")])),_:1}),u(t,{value:"2"},{default:d((()=>[p("预览模式")])),_:1})])),_:1},8,["value"])])),_:1})]),"1"===_.value?(l(),c("div",g,[u(n,null,{default:d((()=>[u(m,{onClick:y},{default:d((()=>[p("单体化面")])),_:1}),u(T,{multiple:!1,name:"file",accept:"json,geojson",showUploadList:!1,beforeUpload:()=>!1,onChange:w},{default:d((()=>[u(m,null,{default:d((()=>[p(" 打开")])),_:1})])),_:1},8,["beforeUpload"]),u(m,{onClick:E},{default:d((()=>[p("保存")])),_:1}),u(m,{onClick:h},{default:d((()=>[p("清除")])),_:1})])),_:1})])):v("",!0)])),_:1})}}});export{m as default};
